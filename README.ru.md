
[![en](https://img.shields.io/badge/lang-en-red.svg)](https://github.com/Qinterfly/KLPFSB/blob/master/README.md)
[![ru](https://img.shields.io/badge/lang-ru-green.svg)](https://github.com/Qinterfly/KLPFSB/blob/master/README.ru.md)

## О программе
Программа предназначена для замены аудио файлов в WormsWMD. Она использует некоторый функционал [vgmstream](https://github.com/vgmstream/vgmstream/tree/master) для изменения содержимого "*.fsb" файлов.

## Использование программы
1. Скачайте последнюю [сборку](https://github.com/Qinterfly/KLPFSB/releases/tag/v.0.0.1) программы и распакуйте её.
2. Исходные банки звуков расположены в следующей директории: "WormsWMD/Audio/PC". Для примера выберем “Speech_RussianMale.fsb”.
3. Откройте этот файл посредством программы [FsbExtractor.exe](http://www.aezay.dk/aezay/fsbextractor/) (она размещена в директории "extra") и извлеките его содержимое в отдельную директорию *Music*.
4. Замените файлы в директории *Music*. Рекомендуем использовать [VLC Player](https://www.videolan.org/vlc/) для конвертации файлов. Они должны отвечать следующим требованиям:
	* Формат: MP3;
	* Кодек: MPEG Audio;
	* Битрейт: 128 бит/c;
	* Канал: 1;
	* Частота дискретизации: 44100 Гц.

5. Используйте [KLPFSB.exe](KLPFSB.exe) задавая следующие опции:
	- -e : Расширение аудио файлов;
	- -i : Путь до ".fsb" файла, содержащего оригинальные аудио файлы. Этот файл используется программой в качестве прототипа;
	- -m : Путь до директории с аудио файлами для замены;
	- -o : Путь до результирующего ".fsb" файла.

Пример использования программы с параметрами:

	./KLPFSB.exe -e ".mp3" -i "examples/input.fsb" -m "examples/music" -o "examples/output.fsb"
	
Кроме того, программа может быть запущена без параметров. Для этого необходимо:
	* Расположить аудио файлы в директории "examples/music";
	* Разместить файл с оригинальным звуковым банком по следующему пути: "examples/input.fsb";
В этом случае после запуска программы создатся файл "examples/output.fsb", который необходимо переименовать и скопировать согласно следующему пункту.

6. Скопируйте результирующий ".fsb" файл в директорию "WormsWMD/Audio/PC".

*Не забудьте осуществить те же операции с файлами "\*_Radio.fsb" для замены всех оригинальных банков звуков.*

## Особенности банков звуков в WormsWMD
При подгрузке банков звуков WormsWMD в том числе проверяются контрольные суммы названий файлов, алгоритм генерирования которых неизвестен. Поэтому генерирование банка звуков посредством [FMOD SoundBank Generator](https://www.fmod.com/) приводит к тому, что звуки общения игроков пропадают вовсе. Это и приводит к необходимости подмены исходных звуковых дорожек с сохранением основной заголовочной информации, необходимой для корректного чтения в WormsWMD.